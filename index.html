<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Combined: RootDonate Live X Vibes & xAI Grok SDK Example</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    body, html {
      margin: 0;
      height: auto;
      background: #000;
      color: #fff;
      font-family: system-ui, sans-serif;
      overflow: auto;
    }
    #map-container {
      position: relative;
      height: 80vh;
    }
    #map { height: 100%; }
    .header {
      position: absolute;
      top: 12px;
      left: 0;
      right: 0;
      text-align: center;
      pointer-events: none;
      z-index: 1000;
    }
    h1 {
      font-size: 2.8rem;
      font-weight: 900;
      letter-spacing: -1px;
      background: linear-gradient(90deg, #0af, #0f5, #f90);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .search {
      position: absolute;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1001;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(8px);
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #444;
      width: 90%;
      max-width: 420px;
      text-align: center;
    }
    input, button {
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      margin: 6px;
    }
    input {
      width: 65%;
      background: #222;
      color: #fff;
    }
    button {
      background: #1da1f2;
      color: #fff;
      cursor: pointer;
    }
    footer {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 10px;
      background: rgba(0,0,0,0.8);
      text-align: center;
      font-size: 0.9rem;
      z-index: 1000;
    }
    pre {
      background: #161b22;
      padding: 1.2rem;
      border-radius: 8px;
      overflow-x: auto;
      border: 1px solid #30363d;
    }
    code {
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
      font-size: 0.95rem;
    }
    .keyword { color: #ff7b72; }
    .string   { color: #a5d6ff; }
    .comment  { color: #8b949e; font-style: italic; }
    .function { color: #d2a8ff; }
    .number   { color: #79c0ff; }
  </style>
</head>
<body>
  <div id="map-container">
  <div id="map"></div>
    <div class="header">
      <h1>RootDonate</h1>
      <button id="load">Load Live X Vibes</button>
    </div>
    <footer>
      <span id="status">Live X vibes • Jan 12 2026 ~19:53 GMT • @iandreme (Swagga Rico) • Carrick interim buzz heavy</span>
    </footer>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // ── Map Setup ────────────────────────────────────────────────
    const map = L.map('map').setView([51.507, -0.128], 11);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      attribution: '© OpenStreetMap & CARTO'
    }).addTo(map);

    // Your avatar (@iandreme / Swagga Rico)
    const youIcon = L.divIcon({
      html: '<div style="width:56px;height:56px;border-radius:50%;overflow:hidden;border:3px solid #0af;box-shadow:0 0 12px #0af"><img src="https://pbs.twimg.com/profile_images/1452130026212765700/q9iBQMu8_400x400.jpg" style="width:100%;height:100%;object-fit:cover"></div>',
      iconSize: [56, 56],
      iconAnchor: [28, 28],
      className: ''
    });

    // X post marker
    const xIcon = L.divIcon({
      html: '<div style="background:#000;border:2px solid #1da1f2;border-radius:50%;width:44px;height:44px;display:flex;align-items:center;justify-content:center;color:#1da1f2;font-weight:bold">X</div>',
      iconSize: [44, 44],
      iconAnchor: [22, 22],
      className: ''
    });

    const postsLayer = L.layerGroup().addTo(map);
    let youMarker = null;

    // ── IMPORTANT: Replace with YOUR secure proxy URL ───────────
    // Example: https://your-vercel-app.vercel.app/api/tweets
    // NEVER put bearer token in client-side code! Use backend for auth.
    const PROXY_API_URL = "1452129905018277888-mo9qtxfsQusC32Hl8GlWp6vi9wy7vM";  // ← CHANGE THIS TO YOUR PROXY!

    async function fetchLivePosts(keyword = '') {
      const baseQuery = '("Michael Carrick" OR Carrick) ("Manchester United" OR MUFC OR "Man Utd") lang:en';
      const q = keyword.trim() ? `${keyword} lang:en` : baseQuery;

      try {
        const res = await fetch(`${PROXY_API_URL}?q=${encodeURIComponent(q)}`);
        if (!res.ok) throw new Error('Proxy error: ' + res.status);
        
        const data = await res.json();
        return (data.data || []).map(tweet => ({
          u: data.includes?.users?.find(u => u.id === tweet.author_id)?.username || 'unknown',
          t: tweet.text,
          url: `https://x.com/i/web/status/${tweet.id}`
        }));
      } catch (err) {
        console.error('Fetch failed:', err);
        document.getElementById('status').textContent = 'Error loading live posts – check proxy setup';
        return fallbackPosts;  // Use static fallback if proxy fails
      }
    }

    // Updated fallback real-time X posts (Jan 12 2026 ~19:53 GMT) – Carrick/MUFC vibes from X API
    const fallbackPosts = [
    ];

    function showYou(lat, lng) {
      if (youMarker) youMarker.remove();
      youMarker = L.marker([lat, lng], {icon: youIcon}).addTo(map)
        .bindPopup("You • @iandreme • Swagga Rico", {autoClose: false}).openPopup();
      map.flyTo([lat, lng], 13, {duration: 1.5});
    }

    function addPost(lat, lng, username, text, url) {
      const marker = L.marker([lat, lng], {icon: xIcon}).addTo(postsLayer);
      marker.bindPopup(`<b>@${username}</b><br>${text.slice(0, 90)}${text.length > 90 ? '...' : ''}<br><a href="${url}" target="_blank" style="color:#1da1f2">→ View on X</a>`);
    }

    async function loadVibes(keyword = '') {
      postsLayer.clearLayers();
      document.getElementById('status').textContent = 'Loading live X vibes...';

      let posts = await fetchLivePosts(keyword);
      if (posts.length === 0) posts = fallbackPosts.filter(p => !keyword || p.t.toLowerCase().includes(keyword.toLowerCase().trim()) || p.u.toLowerCase().includes(keyword.toLowerCase().trim()));

      posts.forEach(p => {
        const offLat = (Math.random() - 0.5) * 0.05;
        const offLng = (Math.random() - 0.5) * 0.07;
        addPost(51.507 + offLat, -0.128 + offLng, p.u, p.t, p.url);
      });

      document.getElementById('status').textContent = `${posts.length} live X posts loaded • Carrick / MUFC vibes • Jan 12 2026 ~19:53 GMT`;
    }

    // GPS → fallback to London
    navigator.geolocation.getCurrentPosition(
      pos => showYou(pos.coords.latitude, pos.coords.longitude),
      () => showYou(51.507, -0.128)
    );

    // Event listeners + auto-load
    document.getElementById('load').onclick = () => {
      loadVibes(document.getElementById('keyword').value);
    };

    setTimeout(() => loadVibes(), 1500);
  </script>
</body>
</html>
```​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​