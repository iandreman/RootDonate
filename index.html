<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RootDonate Mini â€¢ AI + X Vibes</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    body,html{margin:0;height:100%;background:#000;color:#fff;font-family:system-ui,sans-serif;overflow:hidden}
    #map{height:100%}
    .header{position:absolute;top:12px;left:0;right:0;text-align:center;pointer-events:none;z-index:1000}
    h1{font-size:2.8rem;font-weight:900;letter-spacing:-1px;background:linear-gradient(90deg,#0af,#0f5,#f90); -webkit-background-clip:text;background-clip:text;color:transparent}
    .search{position:absolute;top:60px;left:50%;transform:translateX(-50%);z-index:1001;background:rgba(0,0,0,0.7);backdrop-filter:blur(8px);padding:12px;border-radius:12px;border:1px solid #444;width:90%;max-width:420px;text-align:center}
    input,button{padding:8px 12px;border:none;border-radius:6px;margin:6px}
    input{width:65%;background:#222;color:#fff}
    button{background:#1da1f2;color:#fff;cursor:pointer}
    footer{position:absolute;bottom:0;left:0;right:0;padding:10px;background:rgba(0,0,0,0.8);text-align:center;font-size:0.9rem;z-index:1000}
  </style>
</head>
<body>
  <div id="map"></div>

  <div class="header">
    <h1>RootDonate</h1>
  </div>

  <div class="search">
    <input id="keyword" placeholder="carrick / vibes / uk / blank = all" value="">
    <button id="load">Load X Vibes</button>
  </div>

  <footer>
    <span id="status">AI + live X ghosts â€¢ UK 2026</span>
  </footer>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // â”€â”€ Minimal Map â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const map = L.map('map').setView([51.507, -0.128], 11);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      attribution: 'Â© OpenStreetMap & CARTO'
    }).addTo(map);

    // Your avatar
    const youIcon = L.divIcon({
      html: '<div style="width:56px;height:56px;border-radius:50%;overflow:hidden;border:3px solid #0af;box-shadow:0 0 12px #0af"><img src="https://pbs.twimg.com/profile_images/1452130026212765700/q9iBQMu8_400x400.jpg" style="width:100%;height:100%;object-fit:cover"></div>',
      iconSize: [56,56], iconAnchor: [28,28], className: ''
    });

    // Simple X post marker
    const xIcon = L.divIcon({
      html: '<div style="background:#000;border:2px solid #1da1f2;border-radius:50%;width:44px;height:44px;display:flex;align-items:center;justify-content:center;color:#1da1f2;font-weight:bold">X</div>',
      iconSize: [44,44], iconAnchor: [22,22], className: ''
    });

    const postsLayer = L.layerGroup().addTo(map);
    let youMarker = null;

    // Fake "live" posts (replace with real API later)
    const samplePosts = [
      {u:"BenMUFC8", t:"Carrick yes but players dictating manager? Concerning...", url:"https://x.com/BenMUFC8/status/2010757642986070489"},
      {u:"mickyworld37290", t:"Michael Carrick favourite for United interim", url:"https://x.com/mickyworld37290/status/2010757627488170489"},
      {u:"yasssutd", t:"Letâ€™s go Carrick ðŸ‡¬ðŸ‡§ðŸ”´", url:"https://x.com/yasssutd/status/2010757619321807210"},
      {u:"thobbsjourno", t:"palpable anger simmering in the UK right now...", url:"https://x.com/thobbsjourno/status/2010648402388803947"},
      {u:"CrazyVibes_1", t:"Thirteen years married and still ridiculous vibes", url:"https://x.com/CrazyVibes_1/status/2010757200197861550"}
    ];

    function showYou(lat,lng) {
      if (youMarker) youMarker.remove();
      youMarker = L.marker([lat,lng], {icon:youIcon}).addTo(map)
        .bindPopup("You â€¢ Swagga Rico", {autoClose:false}).openPopup();
      map.flyTo([lat,lng], 13, {duration:1.5});
    }

    function addPost(lat,lng,username,text,url) {
      const marker = L.marker([lat,lng], {icon:xIcon}).addTo(postsLayer);
      marker.bindPopup(`<b>@${username}</b><br>${text.slice(0,90)}${text.length>90?'...':''}<br><a href="${url}" target="_blank" style="color:#1da1f2">â†’ X</a>`);
    }

    function loadVibes(keyword='') {
      postsLayer.clearLayers();
      const q = keyword.toLowerCase().trim();
      const filtered = q ? samplePosts.filter(p => p.t.toLowerCase().includes(q) || p.u.toLowerCase().includes(q)) : samplePosts;

      filtered.forEach(p => {
        const off = (Math.random()-0.5)*0.04;
        addPost(51.507 + off, -0.128 + off*1.4, p.u, p.t, p.url);
      });

      document.getElementById('status').textContent = `${filtered.length} X vibes loaded near you`;
    }

    // Try GPS, fallback to London
    navigator.geolocation.getCurrentPosition(
      pos => showYou(pos.coords.latitude, pos.coords.longitude),
      () => showYou(51.507, -0.128)
    );

    // Buttons
    document.getElementById('load').onclick = () => {
      loadVibes(document.getElementById('keyword').value);
    };

    // Auto load once
    setTimeout(() => loadVibes(), 1200);
  </script>
</body>
</html>