<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RootDonate Live X Vibes â€¢ Carrick to MUFC</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    #result { margin-top: 20px; padding: 15px; background: #1a1a1a; border-radius: 8px; white-space: pre-wrap; }
    button { padding: 10px 20px; background: #1d9bf0; border: none; color: white; border-radius: 9999px; cursor: pointer; }
    button:hover { background: #1a8cd8; }
    body, html { margin:0; height:100%; background:#000; color:#fff; font-family:system-ui,sans-serif; overflow:auto; }
    #map-container { position:relative; height:80vh; }
    #map { height:100%; }
    .header { position:absolute; top:12px; left:0; right:0; text-align:center; pointer-events:none; z-index:1000; }
    h1 { font-size:2.8rem; font-weight:900; letter-spacing:-1px; background:linear-gradient(90deg,#0af,#0f5,#f90); -webkit-background-clip:text; background-clip:text; color:transparent; }
    footer { position:absolute; bottom:0; left:0; right:0; padding:10px; background:rgba(0,0,0,0.8); text-align:center; font-size:0.9rem; z-index:1000; }
    input { margin: 5px; padding: 8px; border-radius: 4px; border: 1px solid #333; background: #222; color: #fff; }
    label { pointer-events: all; }
  </style>
</head>
<body>
  <div id="map-container">
    <div id="map"></div>
    <div class="header" style="pointer-events: all;">
      <h1>RootDonate</h1>
      <label for="keyword">Search Keyword:</label>
      <input id="keyword" placeholder="e.g. Carrick MUFC (optional)">
      <label for="tweetId">Tweet ID:</label>
      <input id="tweetId" placeholder="For single tweet (optional)">
      <button id="loadButton" onclick="handleAction()">Load Vibes / Fetch Tweet</button>
      <div id="result"></div>
    </div>
    <footer>
      <span id="status">Jan 13 2026 ~05:07 GMT â€¢ @iandreme (Swagga Rico) â€¢ #MUFC Carrick Era Loading...</span>
    </footer>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // â”€â”€ Map Setup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const map = L.map('map').setView([51.507, -0.128], 11);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      attribution: 'Â© OpenStreetMap & CARTO'
    }).addTo(map);

    // Your avatar marker
    const youIcon = L.divIcon({
      html: '<div style="width:56px;height:56px;border-radius:50%;overflow:hidden;border:3px solid #0af;box-shadow:0 0 12px #0af"><img src="https://pbs.twimg.com/profile_images/1452130026212765700/q9iBQMu8_400x400.jpg" style="width:100%;height:100%;object-fit:cover"></div>',
      iconSize: [56, 56], iconAnchor: [28, 28], className: ''
    });

    // X post marker
    const xIcon = L.divIcon({
      html: '<div style="background:#000;border:2px solid #1da1f2;border-radius:50%;width:44px;height:44px;display:flex;align-items:center;justify-content:center;color:#1da1f2;font-weight:bold">X</div>',
      iconSize: [44, 44], iconAnchor: [22, 22], className: ''
    });

    const postsLayer = L.layerGroup().addTo(map);
    let youMarker = null;

    const corsProxy = 'https://cors-anywhere.herokuapp.com/'; // Note: Visit https://cors-anywhere.herokuapp.com/corsdemo to enable temporary access if needed

    // â”€â”€ Guest Token Fetch â”€â”€
    async function getGuestToken() {
      try {
        const response = await fetch(corsProxy + 'https://api.x.com/1.1/guest/activate.json', {
          method: 'POST',
          headers: {
            'Authorization': 'Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA'
          }
        });
        if (!response.ok) {
          throw new Error('Failed to get guest token');
        }
        const data = await response.json();
        return data.guest_token;
      } catch (error) {
        console.error('Guest token error:', error);
        return null;
      }
    }

    // â”€â”€ Single Tweet Fetch (using GraphQL with guest token) â”€â”€
    async function fetchTweet(tweetId) {
      if (!tweetId) {
        document.getElementById('result').innerHTML = '<strong style="color:red">Error:</strong> Enter Tweet ID!';
        return;
      }

      const guestToken = await getGuestToken();
      if (!guestToken) {
        document.getElementById('result').innerHTML = '<strong style="color:red">Error:</strong> Failed to get guest token. Using fallback.';
        return;
      }

      const variables = {
        tweetId: tweetId,
        withCommunity: false,
        includePromotedContent: false,
        withVoice: false
      };

      const features = {
        creator_subscriptions_tweet_preview_api_enabled: true,
        tweetypie_unmention_optimization_enabled: true,
        responsive_web_edit_tweet_api_enabled: true,
        graphql_is_translatable_rweb_tweet_is_translatable_enabled: true,
        view_counts_everywhere_api_enabled: true,
        longform_notetweets_consumption_enabled: true,
        responsive_web_twitter_article_tweet_consumption_enabled: false,
        tweet_awards_web_tipping_enabled: false,
        freedom_of_speech_not_reach_fetch_enabled: true,
        standardized_nudges_misinfo: true,
        tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled: true,
        longform_notetweets_rich_text_read_enabled: true,
        longform_notetweets_inline_media_enabled: true,
        responsive_web_graphql_exclude_directive_enabled: true,
        verified_phone_label_enabled: false,
        responsive_web_graphql_timeline_navigation_enabled: true,
        responsive_web_graphql_skip_user_profile_image_extensions_enabled: false,
        responsive_web_enhance_cards_enabled: false
      };

      const url = corsProxy + `https://api.x.com/graphql/qxWQxcMLiTPcavz9Qy5hwQ/TweetResultByRestId?variables=${encodeURIComponent(JSON.stringify(variables))}&features=${encodeURIComponent(JSON.stringify(features))}`;

      try {
        const response = await fetch(url, {
          method: 'GET',
          headers: {
            'Authorization': 'Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA',
            'x-guest-token': guestToken
          }
        });

        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const data = await response.json();
        document.getElementById('result').innerHTML = '<strong>Success!</strong><br><pre>' + JSON.stringify(data, null, 2) + '</pre>';
      } catch (error) {
        document.getElementById('result').innerHTML = '<strong style="color:red">Error:</strong> ' + error.message + '<br><br>Query ID may be outdated - check network tab on x.com for current GraphQL ID.';
        console.error(error);
      }
    }

    // â”€â”€ Live Posts Fetch (using GraphQL with guest token for search) â”€â”€
    async function fetchLivePosts(keyword = '') {
      const guestToken = await getGuestToken();
      if (!guestToken) {
        document.getElementById('status').textContent = 'Failed to get guest token â€“ using fallback vibes';
        return fallbackPosts;
      }

      const baseQuery = '("Michael Carrick" OR Carrick) ("Manchester United" OR MUFC OR "Man Utd") lang:en -is:retweet';
      const q = keyword.trim() ? `${keyword} lang:en -is:retweet` : baseQuery;

      const variables = {
        rawQuery: q,
        count: 20,
        product: 'Latest',
        querySource: 'typed_query'
      };

      const features = {
        creator_subscriptions_tweet_preview_api_enabled: true,
        tweetypie_unmention_optimization_enabled: true,
        responsive_web_edit_tweet_api_enabled: true,
        graphql_is_translatable_rweb_tweet_is_translatable_enabled: true,
        view_counts_everywhere_api_enabled: true,
        longform_notetweets_consumption_enabled: true,
        responsive_web_twitter_article_tweet_consumption_enabled: false,
        tweet_awards_web_tipping_enabled: false,
        freedom_of_speech_not_reach_fetch_enabled: true,
        standardized_nudges_misinfo: true,
        tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled: true,
        longform_notetweets_rich_text_read_enabled: true,
        longform_notetweets_inline_media_enabled: true,
        responsive_web_graphql_exclude_directive_enabled: true,
        verified_phone_label_enabled: false,
        responsive_web_graphql_timeline_navigation_enabled: true,
        responsive_web_graphql_skip_user_profile_image_extensions_enabled: false,
        responsive_web_enhance_cards_enabled: false
      };

      const url = corsProxy + `https://api.x.com/graphql/4fpceYZ6-YQCx_JSl_Cn_A/SearchTimeline?variables=${encodeURIComponent(JSON.stringify(variables))}&features=${encodeURIComponent(JSON.stringify(features))}`;

      try {
        const res = await fetch(url, {
          method: 'GET',
          headers: {
            'Authorization': 'Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA',
            'x-guest-token': guestToken
          }
        });
        if (!res.ok) {
          throw new Error(`API error: ${res.status} ${res.statusText}`);
        }
        
        const data = await res.json();
        
        if (!data.data?.search_by_raw_query?.search_timeline?.timeline?.instructions) {
          console.warn('No tweets found in response', data);
          return [];
        }

        // Extract tweets from the response structure
        const entries = data.data.search_by_raw_query.search_timeline.timeline.instructions.find(i => i.type === 'TimelineAddEntries')?.entries || [];
        return entries.filter(e => e.entryId.startsWith('tweet-')).map(entry => {
          const tweet = entry.content.itemContent.tweet_results.result;
          const user = tweet.core.user_results.result;
          return {
            u: user.legacy.screen_name || 'unknown',
            t: tweet.legacy.full_text,
            url: `https://x.com/${user.legacy.screen_name || 'i'}/status/${tweet.rest_id}`
          };
        });
      } catch (err) {
        console.error('Live X fetch failed:', err);
        document.getElementById('status').textContent = `Live fetch error (${err.message}) â€“ using fallback vibes. Query ID may be outdated - inspect x.com/search network tab for current.`;
        return fallbackPosts;
      }
    }

    // â”€â”€ Fresh fallback posts (real recent X vibes ~ Jan 13 2026 05:07 GMT) â”€â”€
    const fallbackPosts = [
      { u: 'CarrickEra', t: 'Manchester United is going to announce Carrick as their interim manager today. \n\nDo you think he gets us European football?', url: 'https://x.com/CarrickEra/status/2010941913810252153' },
      { u: 'manutdtalk_', t: 'ğŸ—£Goldbridge REACTS to reports Michael Carrick is FRONT-RUNNER for Manchester United Interim Manager Job ğŸš¨ #mufc \nhttps://www.youtube.com/shorts/esWf63HmOy0?si=IzCu4e13SlF_hTL1', url: 'https://x.com/manutdtalk_/status/2010941317140865326' },
      { u: 'savagekizz', t: 'Manchester United fans ending up with Michael Carrick seconds after hoping on Xabi Alonso.', url: 'https://x.com/savagekizz/status/2010941142917951501' },
      { u: 'UtdDistrict', t: 'Michael Carrickâ€™s stance on full-time #mufc job revealed as he leads the race for caretaker role â¬‡ï¸ğŸš¨\n\nhttps://utddistrict.co.uk/michael-carricks-stance-on-full-time-man-utd-job-revealed-as-he-leads-the-race-for-caretaker-role/12/01/2026/', url: 'https://x.com/UtdDistrict/status/2010940369777869182' },
      { u: 'zhm_san', t: '@grok carrick record as interim manager in man utd', url: 'https://x.com/zhm_san/status/2010940290203599126' },
      { u: 'MancWorldUK', t: "'Stylish football, two bad Amorim traits': What Manchester United can learn from Michael Carrick spell at Boro https://www.manchesterworld.uk/sport/football/manchester-united/stylish-football-two-bad-amorim-traits-what-manchester-united-can-learn-from-michael-carrick-spell-at-middlesbrough-5472244", url: 'https://x.com/MancWorldUK/status/2010940269412143353' },
      { u: 'SethMUFC', t: 'I need Carrick to have a successful 6 months, I need it. His ideas are modern, and with the right coaching and attitude it can be elite. We as fans will know a lot come the summer. But will the board learn? We might learn even more about them too.', url: 'https://x.com/SethMUFC/status/2010940028935942412' },
      { u: 'YaItsAryaman', t: 'while the world is shook by Xabi Alonso leaving Real Madrid, what is with Michael Carrick managing Manchester United?', url: 'https://x.com/YaItsAryaman/status/2010939144093253867' },
      { u: 'krishg1990', t: "I don't think they didn't pick Ole over Carrick fearing success that's absurd. Carrick being more of a coach has worked in his favour. What we have at United is more of a coaching issue rather than a man management issue. Also Carrick plays possession football. #MUFC", url: 'https://x.com/krishg1990/status/2010937768273424411' },
      { u: 'AfroveraMediaCo', t: 'Michael Carrickâ€™s Shock Return to Manchester United: His First Transfer Is Already Lined Up and Fans Didnâ€™t See It Coming\n#MUFC #PremierLeague #Transfers #MichaelCarrick #RubenNeves\n https://afrovera.com/michael-carrick-man-united-first-transfer-ruben-neves/', url: 'https://x.com/AfroveraMediaCo/status/2010936792787403167' },
      { u: 'SportLaughVibe', t: "I think Michael Carrick needs to sell Bruno Fernandes for the team to settle or demote him from the captain He's not a good leader is Mbappe of Manchester United", url: 'https://x.com/SportLaughVibe/status/2010935004549763541' },
      { u: 'marcel_aromeh', t: "ğŸš¨ğŸš¨| Manchester United didnâ€™t choose Carrick because he was â€œbetterâ€ than Ole.\n\nThey chose him because Oleâ€™s message had run its course.\nSame squad.\nSame problems.\nDifferent voice.\n\nSometimes stability means changing the messenger, not the message.\n\n#Carrick", url: 'https://x.com/marcel_aromeh/status/2010934179815399523' },
      { u: 'dailyreporter24', t: "Man Utd Set to Appoint Michael Carrick as Interim Manager\n\nManchester United is close to naming Michael Carrick as interim boss until seasonâ€™s end, amid distractions from January transfers; the board faces criticism for prioritising PR over signings like Gallagher and Diomande.", url: 'https://x.com/dailyreporter24/status/2010934171175117144' },
      { u: 'JoaoMiguel_TS', t: "ğŸš¨ More to this story, Jonathan Woodgate is being considered to be part of Michael Carrickâ€™s coaching staff. ğŸ”´ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿ #MUFC\n\nOle Gunnar Solskjaer will NOT re-join the club as part of coaching team.", url: 'https://x.com/JoaoMiguel_TS/status/2010933898746966336' },
      { u: 'ManUtdEraHQ', t: "ğŸš¨ Manchester United set minimum target of a top-six finish last summer, but senior officials feel there is a GOLDEN OPPORTUNITY to qualify for the Champions League this season  \n [@TelegraphDucker]\n \nAnd then they hired Carrick instead of OleğŸ˜­\nStupid people running the club", url: 'https://x.com/ManUtdEraHQ/status/2010933705230205057' },
      { u: 'JoaoMiguel_TS', t: 'ğŸš¨ Michael Carrick to Manchester United is DONE! Man United have now agreed to bring in Michael Carrick as new interim manager until the summer. ğŸ”´ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿ #MUFC\n\nUnderstand Man United made a u-turn on Ole Gunnar Solskjaer and have decided to go for Michael Carrick.\n\nMore to follow!', url: 'https://x.com/JoaoMiguel_TS/status/2010933423943164114' },
      { u: 'TrueNorthRedDev', t: 'Carrick retired\nGot his coaching badges\nSpent years as an assistant\nStepped in as interim\nLeft the club\nManaged Middlesbrough for three years\nNow he could be back as interim again & somehow we still havenâ€™t replaced him in midfield ğŸ˜­\n\n#MUFC #ManUtd #ManUnited #ManchesterUnited', url: 'https://x.com/TrueNorthRedDev/status/2010932843971592347' },
      { u: 'tunnarmcniarr', t: 'The fact that he recommended Carrick should be an enough reason for us to go for the other option #mufc', url: 'https://x.com/tunnarmcniarr/status/2010931530391073016' },
      { u: 'J_kimaniw', t: 'I mean, its just common sense, real madrid  is constantly enhancing their squad, last time mufc had a good midfielder was carrick', url: 'https://x.com/J_kimaniw/status/2010930466631926131' },
      { u: 'SethMUFC', t: 'Amorim is a very modern coach, with some ideas that will get him somewhere. But theyâ€™re not enough for the elite level. Xaviâ€™s Barca were questionable OOP hence him being a doubt but I like his ethos and do feel as if he wouldâ€™ve been great in platforming the squad.', url: 'https://x.com/SethMUFC/status/2010939590501179520' }
    ];

    function showYou(lat, lng) {
      if (youMarker) youMarker.remove();
      youMarker = L.marker([lat, lng], {icon: youIcon}).addTo(map)
        .bindPopup("You â€¢ @iandreme â€¢ Swagga Rico", {autoClose: false}).openPopup();
      map.flyTo([lat, lng], 13, {duration: 1.5});
    }

    function addPost(lat, lng, username, text, url) {
      const marker = L.marker([lat, lng], {icon: xIcon}).addTo(postsLayer);
      marker.bindPopup(`<b>@${username}</b><br>${text.slice(0, 90)}${text.length > 90 ? '...' : ''}<br><a href="${url}" target="_blank" style="color:#1da1f2">â†’ View on X</a>`);
    }

    async function loadVibes(keyword = '') {
      postsLayer.clearLayers();
      document.getElementById('status').textContent = 'Loading Carrick / MUFC X vibes...';

      let posts = await fetchLivePosts(keyword);
      if (posts.length === 0) {
        posts = fallbackPosts.filter(p => 
          !keyword || 
          p.t.toLowerCase().includes(keyword.toLowerCase().trim()) || 
          p.u.toLowerCase().includes(keyword.toLowerCase().trim())
        );
      }

      posts.forEach(p => {
        const offLat = (Math.random() - 0.5) * 0.08;
        const offLng = (Math.random() - 0.5) * 0.10;
        addPost(51.507 + offLat, -0.128 + offLng, p.u, p.t, p.url);
      });

      document.getElementById('status').textContent = `${posts.length} X posts loaded â€¢ Carrick to MUFC vibes â€¢ Jan 13 2026 ~05:07 GMT`;
    }

    async function handleAction() {
      const keyword = document.getElementById('keyword').value.trim();
      const tweetId = document.getElementById('tweetId').value.trim();
      document.getElementById('result').innerHTML = '';
      if (tweetId) {
        await fetchTweet(tweetId);
      } else {
        await loadVibes(keyword);
      }
    }

    // GPS or fallback to London
    navigator.geolocation.getCurrentPosition(
      pos => showYou(pos.coords.latitude, pos.coords.longitude),
      () => showYou(51.507, -0.128)
    );

    // Auto load on start
    setTimeout(() => loadVibes(), 1200);
  </script>
</body>
</html>
```â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹