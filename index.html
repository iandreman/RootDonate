<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RootDonate ‚Ä¢ AI + X Posts Live GPS Earth</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    /* Your original styles here ‚Äî I kept them unchanged for brevity */
    :root { --blue: #0a84ff; --green: #30d158; --orange: #ff9f0a; --purple: #ae8cff; --cyan: #00f5d4; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body, html { height: 100%; overflow: hidden; background: #000; color: #fff; font-family: system-ui, sans-serif; }
    #map { width: 100%; height: 100%; filter: brightness(0.9) contrast(1.15); }
    .header { position: absolute; top: 0; left: 0; right: 0; padding: 2.5rem 2rem 1.5rem; text-align: center; z-index: 1000; pointer-events: none; background: linear-gradient(180deg, rgba(0,0,0,0.92), transparent); }
    h1 { font-size: clamp(2.8rem, 7vw, 4.8rem); font-weight: 900; letter-spacing: -2.5px; background: linear-gradient(90deg, var(--blue), var(--green), var(--orange), var(--purple), var(--cyan)); -webkit-background-clip: text; background-clip: text; color: transparent; text-shadow: 0 0 50px rgba(0,245,212,0.4); }
    .poem { margin-top: 1.2rem; font-size: 1.5rem; font-weight: 300; opacity: 0.92; letter-spacing: 0.5px; }
    footer { position: absolute; bottom: 0; left: 0; right: 0; padding: 1.2rem; text-align: center; font-size: 0.95rem; opacity: 0.85; z-index: 1000; background: rgba(0,0,0,0.75); backdrop-filter: blur(18px); display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap; }
    .btn { pointer-events: all; background: rgba(255,255,255,0.14); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.2); border-radius: 12px; padding: 0.6rem 1.3rem; font-size: 0.95rem; cursor: pointer; transition: all 0.25s; color: white; }
    .btn:hover { background: rgba(255,255,255,0.28); transform: translateY(-2px); }
    .search-box { position: absolute; top: 1rem; left: 50%; transform: translateX(-50%); z-index: 1001; pointer-events: all; background: rgba(0,0,0,0.7); backdrop-filter: blur(10px); padding: 1rem; border-radius: 16px; border: 1px solid rgba(255,255,255,0.15); width: 90%; max-width: 500px; text-align: center; }
    input, button { margin: 0.5rem; padding: 0.6rem 1rem; border-radius: 8px; border: none; }
    input { width: 60%; background: rgba(255,255,255,0.1); color: white; }
  </style>
</head>
<body>
  <div id="map"></div>
  <div class="search-wave" id="searchWave"></div>

  <!-- New search box for X posts -->
  <div class="search-box">
    <h3>Hunt X Posts Nearby</h3>
    <input type="text" id="keywordInput" placeholder="e.g. grok OR football" value="uk vibes">
    <button class="btn" id="huntXPosts">üîç Hunt X Posts</button>
  </div>

  <div class="header">
    <h1>RootDonate AI + X</h1>
    <div class="poem" id="poemText">AI ghosts & X crew searching Earth...</div>
  </div>

  <footer>
    <span id="counter">AI + X hunting live GPS...</span>
    <button class="btn" id="shareFootprints">Share Trail</button>
    <button class="btn" id="refreshLocation">Re-search GPS & Crew</button>
    <button class="btn" id="clearFootprints">Clear Ghosts</button>
    <span>‚Ä¢ 2026 ‚Ä¢ UK Swagga Rico vibes</span>
  </footer>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // === YOUR PERSONAL AVATAR ===
    const YOUR_AVATAR = "https://pbs.twimg.com/profile_images/1452130026212765700/q9iBQMu8_400x400.jpg";

    const AI_AVATARS = [
      {name: "Grok", seed: "Grok-xAI"},
      {name: "Claude", seed: "Claude-Anthropic"},
      {name: "Gemini", seed: "Gemini-Google"},
      {name: "RootAI", seed: "RootDonate"}
    ];

    const map = L.map('map', {
      center: [51.5, -0.1], zoom: 6, minZoom: 2, maxZoom: 19,
      zoomControl: false, attributionControl: false
    });

    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: 'abcd', maxZoom: 19
    }).addTo(map);

    const userIcon = L.divIcon({
      className: 'user-avatar-marker',
      html: `<div class="avatar-wrapper user-avatar"><img src="${YOUR_AVATAR}" alt="You" onerror="this.src='https://i.pravatar.cc/150?u=you'"></div>`,
      iconSize: [64, 64], iconAnchor: [32, 32]
    });

    let userMarker = null;
    const footprintsLayer = L.layerGroup().addTo(map);
    const xPostsLayer = L.layerGroup().addTo(map); // New layer for X posts
    const STORAGE_KEY = 'rootdonate_ai_gps_2026';
    let watchId = null;
    let ghostMarkers = [];
    let currentLat = 51.5074, currentLng = -0.1278; // Default London

    function getAIFootprintIcon(seed) {
      const url = `https://api.dicebear.com/9.x/bottts/svg?seed=${encodeURIComponent(seed)}&backgroundColor=1a2533&radius=50`;
      return L.divIcon({
        className: 'footprint-avatar earth-avatar',
        html: `<div class="avatar-wrapper"><img src="${url}" alt="AI"></div>`,
        iconSize: [48, 48], iconAnchor: [24, 24]
      });
    }

    function addFootprint(lat, lng, type = 'human', name = '', isGhost = false) {
      const icon = type === 'ai' ? getAIFootprintIcon(name || 'AI') : userIcon;
      const marker = L.marker([lat, lng], { icon }).addTo(footprintsLayer);
      if (name) marker.bindPopup(`${name} ‚Ä¢ ${type === 'ai' ? 'AI Ghost' : 'Crew'}`);
      saveFootprint(lat, lng, type, name);
      if (isGhost) ghostMarkers.push({marker, baseLat: lat, baseLng: lng});
      return marker;
    }

    // New: Add example X post marker (expand with real data later)
    function addXPostMarker(lat, lng, username, text, tweetUrl) {
      const xIcon = L.divIcon({
        className: 'x-post-marker',
        html: `<div style="background:#000;border:2px solid #1DA1F2;border-radius:50%;width:50px;height:50px;display:flex;align-items:center;justify-content:center;color:#1DA1F2;font-weight:bold;">X</div>`,
        iconSize: [50, 50], iconAnchor: [25, 25]
      });
      const popupContent = `
        <b>@${username}</b><br>
        ${text.substring(0, 120)}${text.length > 120 ? '...' : ''}<br>
        <a href="${tweetUrl}" target="_blank" style="color:#1DA1F2;">View on X ‚Üí</a>
      `;
      L.marker([lat, lng], { icon: xIcon }).addTo(xPostsLayer)
        .bindPopup(popupContent);
    }

    // Hunt real X posts via advanced search URL
    document.getElementById('huntXPosts').onclick = () => {
      const keyword = document.getElementById('keywordInput').value.trim() || 'london';
      const radius = 30; // km
      const query = encodeURIComponent(`${keyword} geocode:${currentLat},${currentLng},${radius}km -filter:retweets lang:en`);
      const xUrl = `https://x.com/search?q=${query}&src=typed_query&f=live`;
      window.open(xUrl, '_blank');
      alert(`Opening X search ‚Üí "${keyword}" near you (¬±${radius}km)\nCopy cool posts & add them manually if you want!`);
    };

    // Your other functions (loadFootprints, saveFootprint, clearAllFootprints, showUser, startAISearch, ipFallback, spawnAICrew) remain the same...
    // ... paste them here from your original code

    // Override showUser to update currentLat/Lng
    function showUser(lat, lng, acc = null, text = 'You ‚Ä¢ live locked') {
      currentLat = lat; currentLng = lng; // Update for X search
      if (userMarker) userMarker.remove();
      userMarker = L.marker([lat, lng], { icon: userIcon })
        .addTo(map)
        .bindPopup(acc ? `${text} (¬±${Math.round(acc)}m)` : text, { closeButton: false, autoClose: false })
        .openPopup();
      map.flyTo([lat, lng], 15, { duration: 2.2 });
    }

    // Example: Add a dummy X post marker near London (replace with real ones)
    setTimeout(() => {
      addXPostMarker(51.5074 + 0.01, -0.1278 + 0.015, "iandreme", "Big UK energy today üá¨üáß What's the vibe?", "https://x.com/iandreme/status/1234567890");
    }, 3000);

    // Init
    loadFootprints();
    startAISearch();
    setTimeout(() => map.invalidateSize(), 500);
  </script>
</body>
</html>